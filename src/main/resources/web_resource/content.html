<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <!-- import CSS -->
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
</head>
<body>
<div id="app">
    <el-row style="height: 100vh;">
        <el-col :xs="3" :sm="3" :md="3" :lg="3" :xl="3" style="height: 100%;">
            <el-menu default-active="1" class="el-menu-vertical-demo" @select="handleSelect">
                <el-menu-item index="1">
                    <i class="el-icon-setting"></i>
                    <span slot="title">隧道列表</span>
                </el-menu-item>
                <el-menu-item index="2">
                    <i class="el-icon-menu"></i>
                    <span slot="title">服务器端口监听</span>
                </el-menu-item>
            </el-menu>
        </el-col>
        <el-col :xs="21" :sm="21" :md="21" :lg="21" :xl="21" style="height: 100%;">
            <transition>
                <router-view></router-view>
            </transition>
        </el-col>
    </el-row>
</div>
</body>
<script src="./js/axios.min.js"></script>
<!-- import Vue before Element -->
<script src="./js/vue.js"></script>
<!-- import JavaScript -->
<script src="./js/index.js"></script>
<script src="./js/vue-router.js"></script>


<script src="./js/utils/InvokeOrderList.js"></script>


<script src="./js/vue_model/serverChannelTable.js"></script>
<script src="./js/vue_model/serverPortTable.js"></script>


<script>
    let static_token

    let invokeOrderList = new InvokeOrderList()
    invokeOrderList.register(serverPortTable)
    invokeOrderList.register(serverChannelTable)
    invokeOrderList.run().then(routes => {
        const routerComponent = new VueRouter({
            routes // (缩写) 相当于 routes: routes
        })


        new Vue({
            el: '#app',
            router: routerComponent,
            data() {
                return {
                    hi: 'view'
                }
            },
            methods: {
                handleSelect(key, keyPath) {
                    if (1 == key) {
                        this.$router.push('/serverChannelTable')
                    }
                    if (2 == key) {
                        this.$router.push('/serverPortTable')
                    }
                },

                getUrlQueryMap() {
                    let urlQueryMap = {}
                    let search = window.location.search.replace("?", "")
                    let searchArray = search.split("&")
                    searchArray.forEach(x => {
                        let keyPoint = x.indexOf("=")
                        if (keyPoint != -1) {
                            let key = x.substring(0, keyPoint)
                            let value = x.substring(keyPoint + 1, x.length)
                            urlQueryMap[key] = value
                        }
                    })
                    return urlQueryMap
                }
            },
            mounted() {
                let queryMap = this.getUrlQueryMap()
                if (typeof (queryMap['token']) == 'undefined') {
                    window.location.href = './index.html'
                } else {
                    static_token = queryMap['token']
                }
            }
        })


    })


</script>

<style lang="scss">


    .el-input__inner {
        color: royalblue;
        font-size: 18px;
    }

    .el-form-item__label {
        /* font-size: 20px; */
        color: white;
        text-align: left;
    }

    .parent {
        display: flex;
        justify-content: center;
        /*主轴上居中*/
        align-items: center;
        /*侧轴上居中*/
    }

    body {
        margin: 0px;
    }
</style>
</html>
